////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////AUTHOR : Sudheer HS	sudheer316@gmail.com////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////DATE : 6-apr-2006							////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////COMPANY : Maruthi Software Developers.,HASSAN - 573201 ,KARANATAKA, INDIA     ////////////////////////////////////////////////////////////////
////////////////Description : This processes key inputs and emulates kannada characters for the key pressed		////////////////////////////////////////////////////////////////
////////////////			 this reads the key pressed and then produces the required characters for kannada languagge		////////////////////////////////////////////////////////////////
////////////////Compiler Used : Microsoft Visual C++ 6.0////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	////////////////////////////////////////////////////////////////	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////  This has been done as a project for Hampi University ,Hampi,INDIA ////////////////////////////////////////////////////////////////
////////////////  this is part of the free software Kuvempu Kannada Thantramsha,launched by Hampi University ////////////////////////////////////////////////////////////////
////////////////  This code as is with out any kind of warranty ,Using or modifing the code or the library without ////////////////////////////////////////////////////////////////
////////////////  the written permission by the university is prohibited,Any such illegal activities is punishable offence as per ////////////////////////////////////////////////////////////////
////////////////  the copy rights ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include <vector>
#include <windows.h>
//#include "..\headers\flags.h"

std::vector<int> g_keystoadd;

void AddKey(int ch)
{
          g_keystoadd.push_back(ch);
}


void PushBackspaces()
{
          HWND hWnd;
          hWnd =  GetActiveWindowHandel();
          do
          {
                    if((g_keystoadd.size()>0) && (g_keystoadd[0]==8))
                    {
                              ::PostMessage(hWnd,WM_KEYDOWN,(WPARAM)VK_BACK,(LPARAM)((0x0e<<16)|1));
                              ::PostMessage(hWnd,WM_KEYUP,(WPARAM)VK_BACK,(LPARAM)((0x0e<<16)|1|(1<<31)));
                              g_keystoadd.erase(g_keystoadd.begin());
					}
                    else
                    break;
		  } 
		  while (g_keystoadd.size()>0);
}


void PushKeys()
{
          if(g_keystoadd.size()==0)
          return;
          HWND hWnd;
          hWnd =  GetActiveWindowHandel();
          while(g_keystoadd.size()>0)
          {
                    //::PostMessageA(hWnd,WM_CHAR,(WPARAM)g_keystoadd[0],(LPARAM)1);
						//	  ::PostMessage(hWnd,WM_KEYDOWN,NULL,(LPARAM)1);
							  ::PostMessageA(hWnd,WM_CHAR,(WPARAM)g_keystoadd[0],(LPARAM)1);
                         //     ::PostMessage(hWnd,WM_KEYUP,NULL,(LPARAM)1);
                    g_keystoadd.erase(g_keystoadd.begin());
		  }
}



void DisplaySingleCharacter(int fval) 
{
AddKey(fval);
}


void DisplayDoubleCharacter(int fval,int sval) 
{
AddKey(fval);
AddKey(sval);
}


void DisplayTripleCharacter(int fval,int sval,int tval) 
{
AddKey(fval);
AddKey(sval);
AddKey(tval);
}


void DisplayFourCharacter(int fval,int sval,int tval,int fhval) 
{
AddKey(fval);
AddKey(sval);
AddKey(tval);
AddKey(fhval);
}



void SendBackSpace(int back)
{
		while(back>=1)
		{
          AddKey(VK_BACK);
          back--;
		}
}


HWND GetActiveWindowHandel()
{
	HWND  hWnd;  //---------Window Handel---//
	hWnd  = GetFocus ();
	
	if (hWnd == NULL)
	
	hWnd = GetForegroundWindow ();
	return hWnd;
}

void SendSpace(int s)
{
while(s-->=1)
	{
          AddKey((WPARAM)246);
    }
}

int isnumpad(WPARAM wParam)
{
	if(wParam == VK_SUBTRACT  ||
       wParam == VK_NUMPAD0   ||
	   wParam == VK_NUMPAD1   ||
	   wParam == VK_NUMPAD2   ||
	   wParam == VK_NUMPAD3   ||
	   wParam == VK_NUMPAD4   ||
	   wParam == VK_NUMPAD5   ||
	   wParam == VK_NUMPAD6   ||
	   wParam == VK_NUMPAD7   ||
	   wParam == VK_NUMPAD8   ||
	   wParam == VK_NUMPAD9   ||
	   wParam == VK_DIVIDE    ||
	   wParam == VK_ADD       ||
	   wParam == VK_MULTIPLY  ||
	   wParam == VK_DECIMAL   )
	{
		
		return 1;
	}
	else
		return 0;
}